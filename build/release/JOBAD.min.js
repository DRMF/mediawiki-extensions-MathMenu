/*
	JOBAD v3
	Minimized version
	built: Fri, 12 Apr 2013 12:28:12 +0200
*/

var JOBAD=function(r){var b,c=function(a){if(!(this instanceof c))return new c(a);var h=this;this.element=a;c.refs._.isElement(this.element)&&(this.element=c.refs.$(this.element));this.element instanceof c.refs.$||c.error("Can't create JOBADInstance: Not a DOM Element. ");var b={},e=[];this.modules={};this.modules.load=function(a,e,f){if(!h.modules.loaded(a)){if("boolean"==typeof f&&f)c.modules.available(a)||c.error("Error loading module "+a),b[a]=new c.modules.loadedModule(a,e,h);else{f=c.modules.getDependencyList(a);
if(!f)return c.console.warn("Unresolved dependencies for module '"+a+"'. "),!1;for(a=0;a<f.length;a++)h.modules.load(f[a],e,!0)}return!0}};this.modules.loaded=function(a){return b.hasOwnProperty(a)};this.modules.deactivate=function(a){h.modules.isActive(a)?c.warn("Module '"+a+"' is already deactivated. "):e.push(a)};this.modules.activate=function(a){h.modules.isActive(a)?c.warn("Module '"+a+"' is already activated. "):e=c.refs._.without(e,a)};this.modules.isActive=function(a){return-1==c.refs._.indexOf(e,
a)};this.modules.iterate=function(a){var c=[],e;for(e in b)if(b.hasOwnProperty(e)&&h.modules.isActive(e)){var f=a(b[e]);if(f)c.push(f);else break}return c};this.modules.iterateAnd=function(a){for(var c in b)if(b.hasOwnProperty(c)&&h.modules.isActive(c)&&!a(b[c]))return!1;return!0};this.Event={};this.Setup=function(){return h.Setup.enable()};this.Setup.enable=function(){var a=h.element,b;for(b in h.Event)c.Events[b].Setup.enable.call(h,a);return!0};this.Setup.disable=function(){return!1};for(var f in c.Events)if(c.Events.hasOwnProperty(f)&&
!c.isEventDisabled(f))if(h.Event[f]=c.util.bindEverything(c.Events[f].namespace,h),"function"==typeof c.Events[f].Setup.init)c.Events[f].Setup.init.call(h,h);else if("object"==typeof c.Events[f].Setup.init)for(var g in c.Events[f].Setup.init)c.Events[f].Setup.init.hasOwnProperty(g)&&(h.hasOwnProperty(g)?c.console.warn("Setup: Event '"+f+"' tried to override '"+g+"'"):h[g]=c.util.bindEverything(c.Events[f].Setup.init[g],h))};c.version="3.0.0";c.config={debug:!0,cleanModuleNamespace:!1,disabledEvents:[]};
c.Events={};c.isEventDisabled=function(a){return-1!=c.config.disabledEvents.indexOf(a)};c.console=_.isUndefined(console)?{log:function(){},warn:function(){},error:function(){}}:{log:function(a){c.config.debug&&console.log(a)},warn:function(a){c.config.debug&&console.warn(a)},error:function(a){c.config.debug&&console.error(a)}};c.error=function(a){c.console.error(a);throw Error(a);};c.modules={};var n={},l={};c.modules.register=function(a){a=c.modules.createProperModuleObject(a);if(!a)return!1;var b=
a.info.identifier;if(c.modules.available(b))return!1;n[b]=a;l[b]={};return!0};c.modules.createProperModuleObject=function(a){if(!c.refs._.isObject(a))return!1;var b={globalinit:function(){},init:function(){}},d;for(d in b)if(b.hasOwnProperty(d)&&a.hasOwnProperty(d)){if("function"!=typeof a[d])return!1;b[d]=a[d]}if(a.hasOwnProperty("info")){var e=a.info;b.info={version:"",dependencies:[]};if(e.hasOwnProperty("version")){if("string"!=typeof e.version)return!1;b.info.version=e.version}b.info.hasCleanNamespace=
e.hasOwnProperty("hasCleanNamespace")?!1==e.hasCleanNamespace?!1:!0:!0;if(e.hasOwnProperty("dependencies")){var f=e.dependencies;if(!c.refs._.isArray(f))return!1;b.info.dependencies=f}try{c.refs._.map(["identifier","title","author","description"],function(a){if(e.hasOwnProperty(a)){var c=e[a];if("string"!=typeof c)throw"";b.info[a]=c}else throw"";})}catch(g){return!1}f=["info","globalinit","init"];b.namespace={};for(d in a)a.hasOwnProperty(d)&&(-1==f.indexOf(d)&&!c.Events.hasOwnProperty(d))&&(b.info.hasCleanNamespace?
c.console.warn("Warning: Module '"+b.info.identifier+"' says its namespace is clean, but property '"+d+"' found. Check ModuleObject.info.hasCleanNamespace. "):b.namespace[d]=a[d]);for(d in c.Events)a.hasOwnProperty(d)&&(b[d]=a[d]);return b}return!1};c.modules.available=function(a,b){b="boolean"==typeof b?b:!1;var d=n.hasOwnProperty(a);if(b&&d){for(var d=n[a].info.dependencies,e=0;e<d.length;e++)if(!c.modules.available(d[e],!0))return!1;return!0}return d};c.modules.getDependencyList=function(a){if(!c.modules.available(a,
!0))return!1;var b=[a];a=n[a].info.dependencies;for(var d=a.length-1;0<=d;d--)b=c.refs._.union(b,c.modules.getDependencyList(a[d]));return b};c.modules.loadedModule=function(a,b,d){c.modules.available(a)||c.error("Module is not available and cant be loaded. ");this.globalStore={get:function(b){return l[a][b+"_"]},set:function(b,c){l[a][b+"_"]=c},"delete":function(b){delete l[a][b+"_"]}};var e={};this.localStore={get:function(a){return e[a]},set:function(a,b){e[a]=b},"delete":function(){delete e[a]}};
var f=n[a];this.info=function(){return f.info};this.getJOBAD=function(){return d};l[a].init||(l[a].init=!0,f.globalinit.apply(void 0,[]));for(var g=[d],k=0;k<b.length;k++)g.push(b[k]);if(c.config.cleanModuleNamespace)f.info.hasCleanNamespace||c.console.warn("Warning: Module '"+a+"' may have unclean namespace, but JOBAD.config.cleanModuleNamespace is true. ");else{b=c.refs._.clone(f.namespace);for(var j in b)!c.Events.hasOwnProperty(j)&&b.hasOwnProperty(j)&&(this[j]=b[j])}for(j in c.Events)this[j]=
f.hasOwnProperty(j)?f[j]:c.Events[j]["default"];f.init.apply(this,g)};c.util={};c.util.bindEverything=function(a,b){if(c.refs._.isObject(a)&&"function"!=typeof a){var d={},e;for(e in a)d[e]=c.util.bindEverything(a[e],b);return d}return"function"==typeof a?c.refs._.bind(a,b):c.refs._.clone(a)};c.refs={};c.refs.$=r;c.refs._=_;c.noConflict=function(){return{_:c.noConflict._(),$:c.noConflict.$()}};c.noConflict.$=function(){c.refs.$=c.refs.$.noConflict();return c.refs.$};c.noConflict._=function(){c.refs._=
c.refs._.noConflict();return c.refs._};b=c;b.config.debug=!1;var p=[0,0];b.refs.$(document).on("mousemove.JOBADListener",function(a){p=[a.pageX-b.refs.$(window).scrollLeft(),a.pageY-b.refs.$(window).scrollTop()]});b.UI={};b.UI.hover={};b.UI.hover.config={offsetX:10,offsetY:10,hoverDelay:1E3};var q=!1,m=void 0;b.UI.hover.enable=function(a){q=!0;m=b.refs.$("<div class='JOBAD JOBADHover'>").html(a).css({position:"fixed","background-color":"grey","-webkit-border-radius":5,"-moz-border-radius":5,"border-radius":5,
border:"1px solid black"});m.appendTo(b.refs.$("body"));b.refs.$(document).on("mousemove.JOBAD.UI.hover",function(){b.UI.hover.refresh()});b.UI.hover.refresh();return!0};b.UI.hover.disable=function(){if(!q)return!1;q=!1;b.refs.$(document).off("mousemove.JOBAD.UI.hover");m.remove()};b.UI.hover.refresh=function(){q&&m.css("top",Math.min(p[1]+b.UI.hover.config.offsetY,window.innerHeight-m.outerHeight(!0))).css("left",Math.min(p[0]+b.UI.hover.config.offsetX,window.innerWidth-m.outerWidth(!0)))};b.UI.ContextMenu=
{};b.UI.ContextMenu.config={margin:20,width:250};b.UI.ContextMenu.enable=function(a,c,d,e){if("function"!=typeof c)return b.error("JOBAD.UI.ContextMenu.enable: demandFunction is not a function"),a;"function"!=typeof d&&(d=function(){});"function"!=typeof e&&(e=function(){});a.on("contextmenu.JOBAD.UI.ContextMenu",function(f){if(f.ctrlKey)return!0;var g=b.refs.$(f.target);f=b.refs.$(f.target);for(var k=!1;!(k=c(g,f))&&!a.is(this);)g=g.parent();if(!k)return!0;b.refs.$(document).trigger("JOBADContextMenuUnbind");
d(a);var j=b.UI.ContextMenu.buildMenuList(k,g,f).menu().css({width:b.UI.ContextMenu.config.width,position:"fixed"}).on("contextmenu",function(){return!1}).on("mousedown",function(a){a.stopPropagation()}).appendTo(b.refs.$("body"));j.css("top",Math.min(p[1],window.innerHeight-j.outerHeight(!0)-b.UI.ContextMenu.config.margin)).css("left",Math.min(p[0],window.innerWidth-j.outerWidth(!0)-b.UI.ContextMenu.config.margin));b.refs.$(document).on("JOBADContextMenuUnbind",function(){j.remove();e(a);b.refs.$(document).unbind("mousedown.UI.ContextMenu.Unbind JOBADContextMenuUnbind")});
b.refs.$(document).on("mousedown.UI.ContextMenu.Unbind",function(){b.refs.$(document).trigger("JOBADContextMenuUnbind")});return!1});return a};b.UI.ContextMenu.disable=function(a){a.off("contextmenu.JOBAD.UI.ContextMenu");return a};b.UI.ContextMenu.buildMenuList=function(a,c,d){for(var e=b.refs.$("<ul>"),f=0;f<a.length;f++){var g=a[f],k=b.refs.$("<a href='#'>");$li=b.refs.$("<li>").appendTo(e).append(k);k.text(g[0]).on("click",function(){return!1});(function(){if("function"==typeof g[1]){var a=g[1];
k.on("click",function(){b.refs.$(document).trigger("JOBADContextMenuUnbind");a(c,d)})}else $li.append(b.UI.ContextMenu.buildMenuList(g[1],c,d))})()}return e};b.UI.Sidebar={};b.UI.Sidebar.config={width:100};b.UI.Sidebar.wrap=function(a){a=$(a);var c=b.refs.$("<div>").css({overflow:"hidden"}),d=b.refs.$("<div>").css({"float":"right",width:b.UI.Sidebar.config.width,height:1,position:"relative"}).addClass("JOBAD_sidebar"),e=b.refs.$("<div>").css({width:"100%","float":"left",overflow:"hidden"});a.wrap(c);
c=a.parent();c.wrap(e);e=c.parent();e.prepend(d);a.data("JOBAD.UI.Sidebar.active",!0);return a};b.UI.Sidebar.unwrap=function(a){a=b.refs.$(a);a.unwrap().parent().find("div").first().remove();a.removeData("JOBAD.UI.Sidebar.active");return a.unwrap()};b.UI.Sidebar.addNotification=function(a,c){var d=b.refs.$(a),e=b.refs.$(c),f=e.offset().top-d.offset().top,d=d.parent().parent().find("div").first(),g=b.refs.$("<div>").css({position:"absolute",top:f}).appendTo(d),f=function(){var a=e.offset().top-d.offset().top;
g.css({top:a})};b.refs.$(window).on("resize.JOBAD.UI.Sidebar",f);return g.data("JOBAD.UI.Sidebar.ResizeHook",f)};b.UI.Sidebar.forceNotificationUpdate=function(){b.refs.$(window).trigger("resize.JOBAD.UI.Sidebar")};b.UI.Sidebar.removeNotification=function(a){var c=a.data("JOBAD.UI.Sidebar.ResizeHook");b.refs.$(window).off("resize.JOBAD.UI.Sidebar",c);a.remove()};b.UI.highlight=function(a){a=b.refs.$(a);a.data("JOBAD.UI.highlight.orgColor")&&a.css("backgroundColor",a.data("JOBAD.UI.highlight.orgColor"));
a.stop().data("JOBAD.UI.highlight.orgColor",a.css("backgroundColor")).animate({backgroundColor:"#FFFF9C"},1E3)};b.UI.unhighlight=function(a){a=b.refs.$(a);a.stop().animate({backgroundColor:a.data("JOBAD.UI.highlight.orgColor")},1E3).removeData("JOBAD.UI.highlight.orgColor")};b.Events.leftClick={"default":function(){return!1},Setup:{enable:function(a){var c=this;a.delegate("*","click.JOBAD.leftClick",function(a){var e=b.refs.$(a.target);switch(a.which){case 1:c.Event.leftClick.trigger(e),a.stopPropagation()}})},
disable:function(a){a.undelegate("*","click.JOBAD.leftClick")}},namespace:{getResult:function(a){return this.modules.iterateAnd(function(b){b.leftClick.call(b,a,b.getJOBAD());return!0})},trigger:function(a){return this.Event.leftClick.getResult(a)}}};b.Events.contextMenuEntries={"default":function(){return[]},Setup:{enable:function(a){var c=this;b.UI.ContextMenu.enable(a,function(a){return c.Event.contextMenuEntries.getResult(a)})},disable:function(a){b.UI.ContextMenu.disable(a)}},namespace:{getResult:function(a){for(var c=
[],d=this.modules.iterate(function(c){c=c.contextMenuEntries.call(c,a,c.getJOBAD());return b.refs._.isArray(c)?c:b.util.generateMenuList(c)}),e=0;e<d.length;e++)for(var f=d[e],g=0;g<f.length;g++)c.push(f[g]);return 0==c.length?!1:c}}};b.util.generateMenuList=function(a){if("undefined"==typeof a)return[];var c=[],d;for(d in a)if(a.hasOwnProperty(d)){var e=a[d];"function"==typeof e?c.push([d,e]):c.push([d,b.util.generateMenuList(e)])}return c};b.Events.hoverText={"default":function(){return!1},Setup:{init:function(){this.Event.hoverText.activeHoverElement=
void 0},enable:function(a){var c=this;a.delegate("*","mouseenter.JOBAD.hoverText",function(d){c.Event.hoverText.trigger(b.refs.$(this))?d.stopPropagation():b.refs.$(this).is(a)||b.refs.$(this).parent().trigger("mouseenter.JOBAD.hoverText",d);return!1}).delegate("*","mouseleave.JOBAD.hoverText",function(){return c.Event.hoverText.untrigger(b.refs.$(this))})},disable:function(a){"undefined"!=typeof this.Event.hoverText.activeHoverElement&&me.Event.hoverText.untrigger();a.undelegate("*","mouseenter.JOBAD.hoverText").undelegate("*",
"mouseleave.JOBAD.hoverText")}},namespace:{getResult:function(a){var c=!1;this.modules.iterate(function(d){var e=d.hoverText.call(d,a,d.getJOBAD());if("undefined"!=typeof e&&"boolean"==typeof c)if("string"==typeof e)c=b.refs.$("<p>").text(e);else if("boolean"!=typeof e)try{c=b.refs.$(e)}catch(f){b.error("Module '"+d.info().identifier+"' returned invalid HOVER result. ")}else!0===e&&(c=!0);return!0});return c},trigger:function(a){if(a.data("JOBAD.hover.Active"))return!1;var c=this.Event.hoverText.getResult(a);
if("boolean"==typeof c)return c;if(this.Event.hoverText.activeHoverElement instanceof b.refs.$){if(this.Event.hoverText.activeHoverElement.is(a))return!0;this.Event.hoverText.untrigger(this.Event.hoverText.activeHoverElement)}this.Event.hoverText.activeHoverElement=a;a.data("JOBAD.hover.Active",!0);var d=window.setTimeout(function(){a.removeData("JOBAD.hover.timerId");b.UI.hover.enable(c.html())},b.UI.hover.config.hoverDelay);a.data("JOBAD.hover.timerId",d);return!0},untrigger:function(a){if("undefined"==
typeof a)if(this.Event.hoverText.activeHoverElement instanceof b.refs.$)a=this.Event.hoverText.activeHoverElement;else return!1;if(!a.data("JOBAD.hover.Active"))return!1;"number"==typeof a.data("JOBAD.hover.timerId")&&(window.clearTimeout(a.data("JOBAD.hover.timerId")),a.removeData("JOBAD.hover.timerId"));a.removeData("JOBAD.hover.Active");this.Event.hoverText.activeHoverElement=void 0;b.UI.hover.disable();return!a.is(this.element)?(this.Event.hoverText.trigger(a.parent()),!1):!0}}};b.Events.onSideBarUpdate=
{"default":function(){},Setup:{init:{Sidebar:{forceUpdate:function(){if(0==b.refs._.keys(this.Sidebar.Elements).length)this.element.data("JOBAD.UI.Sidebar.active")&&b.UI.Sidebar.unwrap(this.element);else{this.element.data("JOBAD.UI.Sidebar.active")||b.UI.Sidebar.wrap(this.element);for(var a in this.Sidebar.Elements)this.Sidebar.Elements[a].data("JOBAD.Events.Sidebar.id")||(this.Sidebar.Elements[a]=b.UI.Sidebar.addNotification(this.element,this.Sidebar.Elements[a]))}b.UI.Sidebar.forceNotificationUpdate();
this.Event.onSideBarUpdate.trigger()},registerNotification:function(a,c){a=b.refs.$(a);var d=(new Date).getTime().toString();this.Sidebar.Elements[d]=a;this.Sidebar.forceUpdate();d=this.Sidebar.Elements[d].data("JOBAD.Events.Sidebar.id",d);d.data("JOBAD.Events.Sidebar.element",a);c="undefined"==typeof c?{}:c;c.hasOwnProperty("text")&&d.text(c.text);c.trace&&d.hover(function(){b.UI.highlight(a)},function(){b.UI.unhighlight(a)});"function"==typeof c.callback&&d.click(c.callback);return d},removeNotification:function(a){if(a instanceof
b.refs.$){var c=a.data("JOBAD.Events.Sidebar.id");b.UI.Sidebar.removeNotification(a);delete this.Sidebar.Elements[c];this.Sidebar.forceUpdate()}else b.error("JOBAD Sidebar Error: Tried to remove invalid Element. ")}}},enable:function(){this.Sidebar.Elements={};this.Event.onSideBarUpdate.enabled=!0},disable:function(){this.Event.onSideBarUpdate.enabled=void 0}},namespace:{getResult:function(){this.Event.onSideBarUpdate.enabled&&this.modules.iterateAnd(function(a){a.onSideBarUpdate.call(a,a.getJOBAD());
return!0})},trigger:function(){this.Event.onSideBarUpdate.getResult()}}};return b}(jQuery);
